var venders=["bithumb","korbit","coinone"],currencys=["btc","bch","eth","xrp","eos","dash","ltc"],ticker={bithumb:{},korbit:{},coinone:{},coinmarket:{},binance:{}},diffList=[],homepage={bithumb:"https://www.bithumb.com",korbit:"https://www.korbit.co.kr",coinone:"https://coinone.co.kr"},krwPerUsd=1e3;function computePrimium(){ticker.binance.btc*=krwPerUsd;for(currency of currencys){var a=ticker.coinmarket[currency],b=ticker.bithumb[currency];document.getElementById(currency+"-average").innerHTML=(+(+b).toFixed(0)).toLocaleString(),document.getElementById(currency+"-primium").innerHTML=(+(100*(b-a)/a)).toFixed(2)+"%","btc"!=currency&&(ticker.binance[currency]*=ticker.binance.btc);var c=ticker.binance[currency],d=100*(b-c)/c;document.getElementById(currency+"-binance").innerHTML=(+(+c).toFixed(0)).toLocaleString(),document.getElementById(currency+"-binance-diff").innerHTML=(+d).toFixed(2)+"%","btg"!=currency&&diffList.push({currency:currency,diff:d})}}function getMaxVender(a){var b=venders[0];for(vender of venders)ticker[vender][a]>ticker[b][a]&&(b=vender);return b}function getMinVender(a){var b=venders[0];for(vender of venders)ticker[vender][a]<ticker[b][a]&&(b=vender);return b}function computeArbitrage(){for(currency of currencys){var a=getMaxVender(currency),b=getMinVender(currency);document.getElementById(currency+"-arbitrage").innerHTML=a+" - "+b;var c=100*(ticker[a][currency]-ticker[b][currency])/ticker[b][currency];document.getElementById(currency+"-arbitrage-percent").innerHTML=(+c).toFixed(2)+" %"}diffList.sort(function(c,a){return c.diff-a.diff});var a=diffList[diffList.length-1],b=diffList[0];document.getElementById("binance-arbitrage").innerHTML="binance arbitrage: "+a.currency.toUpperCase()+" - "+b.currency.toUpperCase()+" = "+(+(a.diff-b.diff)).toFixed(2)+" %"}function setBithumbPrice(a,b){var c=b.data[a.toUpperCase()];ticker.bithumb[a]=+c.closing_price,document.getElementById(a+"-bithumb").innerHTML=(+c.closing_price).toLocaleString(),document.getElementById(a+"-change-bithumb").innerHTML=(+(100*(c.closing_price-c.opening_price)/c.opening_price)).toFixed(2)+"%",+c.closing_price>+c.opening_price?(document.getElementById(a+"-change-bithumb").style.color="red",document.getElementById(a+"-change-bithumb").innerHTML+=" <img src=http://static.naver.net/nfinance/ico_up.gif style='vertical-align:middle'>"):(document.getElementById(a+"-change-bithumb").style.color="blue",document.getElementById(a+"-change-bithumb").innerHTML+=" <img src=http://static.naver.net/nfinance/ico_down.gif style='vertical-align:middle'>")}function fetchUsdRate(){return fetch("https://api.manana.kr/exchange/rate/KRW/USD.json").then(function(a){return a.json()}).then(function(a){krwPerUsd=a.rate,document.getElementById("krw_usd").innerHTML=(+krwPerUsd).toLocaleString()})}function fetchBithumb(){return fetch("https://api.bithumb.com/public/ticker/all").then(function(a){return a.json()}).then(function(a){for(currency of currencys)setBithumbPrice(currency,a)})}function fetchKorbit(){return fetch("https://conanoc-eval-prod.apigee.net/korbit").then(function(a){return a.json()}).then(function(a){for(currency of currencys)void 0!==a[currency]&&(ticker.korbit[currency]=+a[currency].last,document.getElementById(currency+"-korbit").innerHTML=(+a[currency].last).toLocaleString())})}function fetchCoinone(){return fetch("https://conanoc-eval-prod.apigee.net/coinone").then(function(a){return a.json()}).then(function(a){for(currency of currencys)void 0!==a[currency]&&(ticker.coinone[currency]=+a[currency].last,document.getElementById(currency+"-coinone").innerHTML=(+a[currency].last).toLocaleString())})}function fetchCoinmarket(){return fetch("https://api.coinmarketcap.com/v1/ticker/?convert=krw&limit=20").then(function(a){return a.json()}).then(function(a){for(item of a){var b=item.symbol.toLowerCase();currencys.includes(b)&&(ticker.coinmarket[b]=+item.price_krw,document.getElementById(b+"-coinmarket").innerHTML=(+(+item.price_krw).toFixed()).toLocaleString(),document.getElementById(b+"-change-coinmarket").innerHTML=(+item.percent_change_24h).toFixed(2)+"%",0<item.percent_change_24h?(document.getElementById(b+"-change-coinmarket").style.color="red",document.getElementById(b+"-change-coinmarket").innerHTML+=" <img src=http://static.naver.net/nfinance/ico_up.gif style='vertical-align:middle'>"):(document.getElementById(b+"-change-coinmarket").style.color="blue",document.getElementById(b+"-change-coinmarket").innerHTML+=" <img src=http://static.naver.net/nfinance/ico_down.gif style='vertical-align:middle'>"))}})}function fetchBinance(){return fetch("https://conanoc-eval-prod.apigee.net/binance").then(function(a){return a.json()}).then(function(a){var b=0;for(item of a){var c=item.symbol.substring(0,3).toLowerCase();if("bcc"==c?(c="bch",item.symbol="BCH"+item.symbol.substring(3)):"das"==c&&(c="dash"),("btc"==c||currencys.includes(c)&&item.symbol.toLowerCase()==c+"btc")&&(ticker.binance[c]=+item.price,b++),b==currencys.length)break}})}function getTableBody(a,b=!1){var c="";for(currency of currencys){if(c+="<tr><td align=center>"+currency.toUpperCase()+"</td>",b){c+="<td id="+currency+"-arbitrage align=center>\uB85C\uB529\uC911</td>",c+="<td id="+currency+"-arbitrage-percent align=right>0</td>",c+="</tr>";continue}for(vender of a)c+="btc"==currency?"<td id="+currency+"-"+vender+" align=right>\uB85C\uB529\uC911</td>":"<td id="+currency+"-"+vender+" align=right>0</td>",("bithumb"==vender||"coinmarket"==vender)&&(c+="<td><div id="+currency+"-change-"+vender+" align=right style='width: 60px'>-</div></td>"),"coinmarket"==vender&&(c+="<td id="+currency+"-average align=right>0</td>",c+="<td id="+currency+"-primium align=right>0</td>",c+="<td id="+currency+"-binance align=right>0</td>",c+="<td id="+currency+"-binance-diff align=right>0</td>");c+="</tr>"}return c}function writeTable(){for(vender of venders)document.getElementById("currency-header-local").innerHTML+="<th><a target=_ href="+homepage[vender]+">"+vender+"</a></th>","bithumb"==vender&&(document.getElementById("currency-header-local").innerHTML+="<th width>24H</th>");document.getElementById("currency-header-arbitrage").innerHTML+="<th>\uCC28\uC775 \uAE30\uC900</th>",document.getElementById("currency-header-arbitrage").innerHTML+="<th>\uCC28\uC775 %</th>",document.getElementById("currency-header-primium").innerHTML+="<th>coinmarket</th>",document.getElementById("currency-header-primium").innerHTML+="<th>24H</th>",document.getElementById("currency-header-primium").innerHTML+="<th>bithumb</th>",document.getElementById("currency-header-primium").innerHTML+="<th>\uAE40\uD5041</th>",document.getElementById("currency-header-primium").innerHTML+="<th>binance</th>",document.getElementById("currency-header-primium").innerHTML+="<th>\uAE40\uD5042</th>",document.getElementById("currency-tbody-local").innerHTML=getTableBody(venders),document.getElementById("currency-tbody-arbitrage").innerHTML=getTableBody(null,!0),document.getElementById("currency-tbody-primium").innerHTML=getTableBody(["coinmarket"])}function loadPage(){if("http:"==location.protocol&&location.host.startsWith("conanoc"))return void(location.href="https:"+window.location.href.substring(window.location.protocol.length));writeTable();var a=fetchBithumb(),b=fetchKorbit(),c=fetchCoinone(),d=fetchCoinmarket(),e=fetchBinance(),f=fetchUsdRate();Promise.all([a,c,b,d,e,f]).then(function(){computePrimium(),computeArbitrage()})}