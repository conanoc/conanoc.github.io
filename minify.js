var venders=["bithumb","korbit","coinone"],currencys=["btc","bch","eth","xrp","eos","dash","ltc"],ticker={bithumb:{},korbit:{},coinone:{},coinmarket:{},binance:{}},diffList=[],homepage={bithumb:"https://www.bithumb.com",korbit:"https://www.korbit.co.kr",coinone:"https://coinone.co.kr"},krwPerUsd=1e3;function computePrimium(){ticker.binance.btc*=krwPerUsd;for(currency of currencys){var c=ticker.coinmarket[currency],d=ticker.bithumb[currency];document.getElementById(currency+"-average").innerHTML=(+(+d).toFixed(0)).toLocaleString(),document.getElementById(currency+"-primium").innerHTML=(+(100*(d-c)/c)).toFixed(2)+"%","btc"!=currency&&(ticker.binance[currency]*=ticker.binance.btc);var f=ticker.binance[currency],g=100*(d-f)/f;document.getElementById(currency+"-binance").innerHTML=(+(+f).toFixed(0)).toLocaleString(),document.getElementById(currency+"-binance-diff").innerHTML=(+g).toFixed(2)+"%","btg"!=currency&&diffList.push({currency:currency,diff:g})}}function getMaxVender(c){var d=venders[0];for(vender of venders)ticker[vender][c]>ticker[d][c]&&(d=vender);return d}function getMinVender(c){var d=venders[0];for(vender of venders)ticker[vender][c]<ticker[d][c]&&(d=vender);return d}function computeArbitrage(){for(currency of currencys){var c=getMaxVender(currency),d=getMinVender(currency);document.getElementById(currency+"-arbitrage").innerHTML=c+" - "+d;var e=100*(ticker[c][currency]-ticker[d][currency])/ticker[d][currency];document.getElementById(currency+"-arbitrage-percent").innerHTML=(+e).toFixed(2)+" %"}diffList.sort(function(f,g){return f.diff-g.diff});var c=diffList[diffList.length-1],d=diffList[0];document.getElementById("binance-arbitrage").innerHTML="binance arbitrage: "+c.currency.toUpperCase()+" - "+d.currency.toUpperCase()+" = "+(+(c.diff-d.diff)).toFixed(2)+" %"}function setBithumbPrice(c,d){var e=d.data[c.toUpperCase()];ticker.bithumb[c]=+e.closing_price,document.getElementById(c+"-bithumb").innerHTML=(+e.closing_price).toLocaleString(),document.getElementById(c+"-change-bithumb").innerHTML=(+(100*(e.closing_price-e.opening_price)/e.opening_price)).toFixed(2)+"%",+e.closing_price>+e.opening_price?(document.getElementById(c+"-change-bithumb").style.color="red",document.getElementById(c+"-change-bithumb").innerHTML+=" <img src=http://static.naver.net/nfinance/ico_up.gif style='vertical-align:middle'>"):(document.getElementById(c+"-change-bithumb").style.color="blue",document.getElementById(c+"-change-bithumb").innerHTML+=" <img src=http://static.naver.net/nfinance/ico_down.gif style='vertical-align:middle'>")}function fetchUsdRate(){return fetch("https://conanoc-eval-prod.apigee.net/earthquake").then(function(c){return c.json()}).then(function(c){krwPerUsd=c.USDKRW[0],document.getElementById("krw_usd").innerHTML=(+krwPerUsd).toLocaleString()})}function fetchBithumb(){return fetch("https://api.bithumb.com/public/ticker/all").then(function(c){return c.json()}).then(function(c){for(currency of currencys)setBithumbPrice(currency,c)})}function fetchKorbit(){return fetch("https://conanoc-eval-prod.apigee.net/korbit").then(function(c){return c.json()}).then(function(c){for(currency of currencys)void 0!==c[currency]&&(ticker.korbit[currency]=+c[currency].last,document.getElementById(currency+"-korbit").innerHTML=(+c[currency].last).toLocaleString())})}function fetchCoinone(){return fetch("https://conanoc-eval-prod.apigee.net/coinone").then(function(c){return c.json()}).then(function(c){for(currency of currencys)void 0!==c[currency]&&(ticker.coinone[currency]=+c[currency].last,document.getElementById(currency+"-coinone").innerHTML=(+c[currency].last).toLocaleString())})}function fetchCoinmarket(){return fetch("https://api.coinmarketcap.com/v1/ticker/?convert=krw&limit=20").then(function(c){return c.json()}).then(function(c){for(item of c){var d=item.symbol.toLowerCase();currencys.includes(d)&&(ticker.coinmarket[d]=+item.price_krw,document.getElementById(d+"-coinmarket").innerHTML=(+(+item.price_krw).toFixed()).toLocaleString(),document.getElementById(d+"-change-coinmarket").innerHTML=(+item.percent_change_24h).toFixed(2)+"%",0<item.percent_change_24h?(document.getElementById(d+"-change-coinmarket").style.color="red",document.getElementById(d+"-change-coinmarket").innerHTML+=" <img src=http://static.naver.net/nfinance/ico_up.gif style='vertical-align:middle'>"):(document.getElementById(d+"-change-coinmarket").style.color="blue",document.getElementById(d+"-change-coinmarket").innerHTML+=" <img src=http://static.naver.net/nfinance/ico_down.gif style='vertical-align:middle'>"))}})}function fetchBinance(){return fetch("https://conanoc-eval-prod.apigee.net/binance").then(function(c){return c.json()}).then(function(c){var d=0;for(item of c){var e=item.symbol.substring(0,3).toLowerCase();if("bcc"==e?(e="bch",item.symbol="BCH"+item.symbol.substring(3)):"das"==e&&(e="dash"),("btc"==e||currencys.includes(e)&&item.symbol.toLowerCase()==e+"btc")&&(ticker.binance[e]=+item.price,d++),d==currencys.length)break}})}function getTableBody(c,d=!1){var e="";for(currency of currencys){if(e+="<tr><td align=center>"+currency.toUpperCase()+"</td>",d){e+="<td id="+currency+"-arbitrage align=center>\uB85C\uB529\uC911</td>",e+="<td id="+currency+"-arbitrage-percent align=right>0</td>",e+="</tr>";continue}for(vender of c)e+="btc"==currency?"<td id="+currency+"-"+vender+" align=right>\uB85C\uB529\uC911</td>":"<td id="+currency+"-"+vender+" align=right>0</td>",("bithumb"==vender||"coinmarket"==vender)&&(e+="<td><div id="+currency+"-change-"+vender+" align=right style='width: 60px'>-</div></td>"),"coinmarket"==vender&&(e+="<td id="+currency+"-average align=right>0</td>",e+="<td id="+currency+"-primium align=right>0</td>",e+="<td id="+currency+"-binance align=right>0</td>",e+="<td id="+currency+"-binance-diff align=right>0</td>");e+="</tr>"}return e}function writeTable(){for(vender of venders)document.getElementById("currency-header-local").innerHTML+="<th><a target=_ href="+homepage[vender]+">"+vender+"</a></th>","bithumb"==vender&&(document.getElementById("currency-header-local").innerHTML+="<th width>24H</th>");document.getElementById("currency-header-arbitrage").innerHTML+="<th>\uCC28\uC775 \uAE30\uC900</th>",document.getElementById("currency-header-arbitrage").innerHTML+="<th>\uCC28\uC775 %</th>",document.getElementById("currency-header-primium").innerHTML+="<th>coinmarket</th>",document.getElementById("currency-header-primium").innerHTML+="<th>24H</th>",document.getElementById("currency-header-primium").innerHTML+="<th>bithumb</th>",document.getElementById("currency-header-primium").innerHTML+="<th>\uAE40\uD5041</th>",document.getElementById("currency-header-primium").innerHTML+="<th>binance</th>",document.getElementById("currency-header-primium").innerHTML+="<th>\uAE40\uD5042</th>",document.getElementById("currency-tbody-local").innerHTML=getTableBody(venders),document.getElementById("currency-tbody-arbitrage").innerHTML=getTableBody(null,!0),document.getElementById("currency-tbody-primium").innerHTML=getTableBody(["coinmarket"])}function loadPage(){if("http:"==location.protocol&&location.host.startsWith("conanoc"))return void(location.href="https:"+window.location.href.substring(window.location.protocol.length));writeTable();var c=fetchBithumb(),d=fetchKorbit(),e=fetchCoinone(),f=fetchCoinmarket(),g=fetchBinance(),h=fetchUsdRate();Promise.all([c,e,d,f,g,h]).then(function(){computePrimium(),computeArbitrage()})}